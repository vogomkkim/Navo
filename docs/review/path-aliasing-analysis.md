# 경로 별칭(Path Alias) 문제 원인 분석 (2025-09-02)

이 문서는 여러 모듈에서 공통으로 발생하는 경로 별칭 문제의 원인 분석 결과를 정리합니다.

---

## 현상

`@/db/...` 와 같은 경로 별칭을 사용하여 데이터베이스 연결 인스턴스를 가져오려고 할 때, "모듈을 찾을 수 없음(Cannot find module)" 오류가 발생합니다.

## 원인 분석

### 1. `tsconfig.json`의 별칭 정의
- `server/tsconfig.json` 파일에 따르면, `@/db/*` 별칭은 `../drizzle/*` 경로를 가리킵니다.
- 이 경로는 `server/` 디렉터리에서 상위로 이동한 후, 프로젝트 루트의 `drizzle/` 폴더를 의미합니다.
- 해당 `drizzle/` 폴더는 데이터베이스 **스키마**(`schema.ts`)와 **마이그레이션** 관련 파일들을 담고 있습니다.

### 2. 실제 코드의 `import` 대상
- `projects`, `pages` 등 각 모듈의 `repository`에서는 데이터베이스 **연결 인스턴스**인 `db` 객체를 필요로 합니다.
- 이 `db` 객체는 `server/src/modules/db/db.instance.js` 파일에 정의되어 있을 것으로 추정됩니다.

### 3. 문제의 핵심: 별칭의 목적과 실제 사용의 불일치
- `@/db/*` 별칭은 **스키마 파일**에 접근하기 위해 만들어졌습니다.
- 하지만 실제로는 **DB 연결 인스턴스**를 가져오기 위해 이 별칭을 사용하려고 시도했기 때문에 문제가 발생합니다.
- 즉, `import { db } from '@/db/db.instance.js'` 코드는 존재하지 않는 `ROOT/drizzle/db.instance.js` 파일을 찾으려고 시도하게 되어 오류가 발생한 것입니다.

## 결론

문제의 근본 원인은 **별칭의 설정 목적과 실제 사용 목적이 달랐기 때문**입니다. `@/db/*` 별칭은 스키마용이며, DB 연결 인스턴스를 위한 별칭이 아니거나 잘못 설정되었습니다.

---

## 해결 방안

### 옵션 1: 별칭 재정의
```json
// tsconfig.json
{
  "compilerOptions": {
    "paths": {
      "@/db/*": ["../db/*"],        // DB 연결 인스턴스용
      "@/schema/*": ["../drizzle/*"] // 스키마 파일용
    }
  }
}
```

### 옵션 2: 현재 방식 유지 (권장)
- 상대 경로 사용으로 일관성 유지
- 경로 별칭 통일은 나중에 전체 프로젝트 리팩토링 시 진행

## 권장사항

현재 상황에서는 **옵션 2 (현재 방식 유지)**를 권장합니다:

1. **안정성**: 현재 작동하는 상대 경로 방식 유지
2. **일관성**: 모든 모듈에서 동일한 패턴 사용
3. **우선순위**: 3차, 4차 우선순위 완료 후 경로 별칭 통일 작업 진행
