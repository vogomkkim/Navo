import { UserContext, ChatMessage } from './contextManager.js';
import { parseJsonFromMarkdown } from '../utils/jsonExtractor.js';
import { IntentAnalysis } from './types/intent.js';
import { analyzeIntent, extractEntities } from './utils/intentUtils.js';

export const intentAnalyzer = {
  async analyze(text, context = {}) {
    const intent = analyzeIntent(text);
    const entities = extractEntities(text);

    return new IntentAnalysis(
      intent.intent,
      intent.confidence,
      entities
    );
  },

  async enhancePrompt(prompt, context = {}) {
    const analysis = await this.analyze(prompt, context);

    return {
      originalPrompt: prompt,
      enhancedPrompt: prompt,
      intent: analysis,
      context
    };
  }
};
